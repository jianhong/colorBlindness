---
title: "colorBlindness Guide"
author: "Jianhong Ou"
date: "`r BiocStyle::doc_date()`"
package: "`r BiocStyle::pkg_ver('colorBlindness')`"
bibliography: bibliography.bib
csl: nature.csl
vignette: >
    %\VignetteIndexEntry{colorBlindness Vignette}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
output:
  html_document:
    theme: simplex
    toc: true
    toc_float: true
    toc_depth: 4
---

```{r, echo=FALSE, results="hide", warning=FALSE}
suppressPackageStartupMessages({
  library(colorBlindness)
  library(ggplot2)
  library(reshape2)
})
knitr::opts_chunk$set(warning=FALSE, message=FALSE, eval=TRUE)
```

# Introduction

This package is designed to provide a collection of safe colors for plots 
such as heatmaps, pie chart.

There are lots of package already collected lots of safe colors:
  
* [munsell](https://cran.r-project.org/web/packages/munsell/index.html)

* [viridis](https://cran.r-project.org/web/packages/viridis/index.html) and [RColorBrewer](https://cran.r-project.org/web/packages/RColorBrewer/index.html)

* [dichromat](https://cran.r-project.org/web/packages/dichromat/index.html)

* [colorblindr](https://github.com/clauswilke/colorblindr)

* [shades](https://cran.r-project.org/web/packages/shades/index.html)

* [ggsci](https://cran.r-project.org/web/packages/ggsci/index.html)


# Color vision deficiency (CVD) simulator

* Hans Brettel 1997[@brettel1997computerized]

* Francoise Vienot 1999[@vienot1999digital] (implemented in this package and package [dichromat](https://cran.r-project.org/web/packages/dichromat/index.html) )

* Gustavo M. Machado 2009[@machado2009physiologically] (implemented in package [colorspace](https://cran.r-project.org/web/packages/colorspace/index.html))

*

# Use safe color to plot heatmap

```{r,fig.width=12,fig.height=12}
library(colorBlindness)
mat <- matrix(1:81, nrow = 9, ncol = 9)

cvdPlot(heatmap(mat, col=Blue2DarkRed12Steps))

library(ComplexHeatmap)
ht <- Heatmap(mat, col = Blue2DarkRed12Steps,
              cluster_rows = FALSE, cluster_columns = FALSE)
cvdPlot(ht)

library(pheatmap)
cvdPlot(pheatmap(mat, col = Blue2DarkRed12Steps,
                 cluster_rows = FALSE, cluster_cols = FALSE))

library(ggplot2)
library(reshape2)
mat <- melt(t(mat[9:1, ]))
len <- length(Blue2DarkRed12Steps)-1
mat$v2 <- cut(mat$value,
              breaks = seq(0,ceiling(81/len)*len, 
                           length.out = len+1))
ht <- ggplot(mat) + 
  geom_tile(aes(x=Var1, y=Var2, fill=v2)) + 
  scale_fill_manual(values=Blue2DarkRed12Steps) + 
  theme_bw()
cvdPlot(ht)
```


# replace the color of a plot to safe color

```{r}
cvdPlot(replacePlotColor(displayColors(c("Red", "Green", "blue"))))
```
```{r}
## replace the color of a file
biocLogo <- "https://www.bioconductor.org/images/logo/jpg/bioconductor_logo_rgb.jpg"
f <- tempfile()
download.file(biocLogo, destfile = f, mode = "wb")
library(jpeg)
img <- readJPEG(f)
unlink(f)
g <- rasterGrob(img, interpolate=TRUE)
cvdPlot(g)
cvdPlot(replacePlotColor(g))

ishihara74 <- system.file("extdata", "Ishihara_9.png", package = "colorBlindness")
library(png)
img <- readPNG(ishihara74)
g <- rasterGrob(img, interpolate=TRUE)
cvdPlot(g)
cvdPlot(replacePlotColor(g))

path <- system.file("extdata", package = "colorBlindness")
img <- lapply(file.path(path, paste0("Plate", 1:25, ".png")), readPNG)
g <- lapply(img, rasterGrob, interpolate=TRUE)
null <- lapply(g, function(.ele) grid.draw(cvdPlot(replacePlotColor(.ele))))
```


# Collection of safe colors

## safeColor 

### color collection from Bang Wong[@wong2011points]

```{r}
displayAllColors(safeColors, color="white")
```


## palette

### 15 Color palettes for color blindness from Martin Krzywinski

See also [GETTING INTO VISUALIZATION OF LARGE BIOLOGICAL DATA SETS](http://mkweb.bcgsc.ca/biovis2012/krzywinski-visualizing-biological-data.pdf)

```{r}
displayAllColors(paletteMartin, color="white")
```

### Color palettes from Adam Light[@light2004end]

See also [Color Schemes Appropriate for Scientific Data Graphics](http://geog.uoregon.edu/datagraphics/color_scales.htm)

#### Green to Magenta

Useful for generic diverging data. 

```{r}
displayAllColors(Green2Magenta16Steps, color="white")
```

#### Blue to Dark Red

Useful for temperature-like data, with a subjective interpretation (blue=cold, red=hot)

```{r}
displayAllColors(Blue2DarkRed12Steps, color="white")
displayAllColors(Blue2DarkRed18Steps, color="white")
displayAllColors(Blue2OrangeRed14Steps, color="white")
```


#### Blue to Orange

Useful for data like sea-level pressure, with ansubjective association (blue=low, wet, orange=high, dry) 

```{r}
displayAllColors(Blue2Orange8Steps, color="white")
displayAllColors(Blue2Orange10Steps, color="white")
displayAllColors(Blue2Orange12Steps, color="white")
```


#### Blue to Green

Useful for data with a winter (blue) vs. summer (green) association.

```{r}
displayAllColors(Blue2Green14Steps, color="white")
```


#### Brown to Blue

Useful for data with a dry (brown) vs. wet (blue) association.

```{r}
displayAllColors(Brown2Blue10Steps, color="white")
displayAllColors(Brown2Blue12Steps, color="white")
```


#### Blue to Gray

Useful in particular for diverging data like cloudiness anomalies.

```{r}
displayAllColors(Blue2Gray8Steps, color="white")
```


#### Blue to Dark Orange

Useful for data without a specific subjective color association.

```{r}
displayAllColors(Blue2DarkOrange12Steps, color="white")
displayAllColors(Blue2DarkOrange18Steps, color="white")
```

#### Others

```{r}
displayAllColors(ModifiedSpectralScheme11Steps, color="white")
displayAllColors(LightBlue2DarkBlue7Steps, color="white")
displayAllColors(LightBlue2DarkBlue10Steps, color="white")
displayAllColors(PairedColor12Steps, color="white")
displayAllColors(SteppedSequential5Steps, color="white")
```


# Session Info
```{r sessionInfo}
sessionInfo()
```

# References
